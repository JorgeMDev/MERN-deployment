{"ast":null,"code":"var _jsxFileName = \"/Users/jorgemartinez/Documents/MERN-deployment/client/src/components/Main.jsx\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport React, { useState, useEffect } from 'react';\nimport AdminTable from './AdminTable';\nimport Histogram from './Histogram';\nimport { useNavigate } from 'react-router-dom';\nimport NavBarMui from './NavBarMui';\nimport Statuses from './Statuses';\nimport VerificationTable from './VerificationTable';\nimport RepView from './RepView';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Main = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const [customers, setCustomers] = useState([]);\n  const [repsWithCustomer, setRepWithCustomer] = useState([]);\n  const [userRole, setUserRole] = useState('');\n  const [thisMonth, setThisMonth] = useState('');\n  const [userFirstName, setUserFirstName] = useState('');\n  useEffect(() => {\n    axios.get(process.env.REACT_APP_API_URL + '/api/customers/all', {\n      withCredentials: true\n    }).then(response => {\n      setCustomers(response.data); // Create a new Date object\n\n      const currentDate = new Date(); // Get the month (0-indexed, so we add 1 to get the correct month)\n\n      const month = currentDate.getMonth() + 1; // Set the current month in the state\n\n      setThisMonth(month.toString());\n    }).catch(err => navigate(\"/login\")); //retrieve customers with reps\n\n    axios.get(process.env.REACT_APP_API_URL + '/api/user/all/customers', {\n      withCredentials: true\n    }).then(response => {\n      setRepWithCustomer(response.data);\n    }).catch(err => console.log(err));\n    axios.get(process.env.REACT_APP_API_URL + '/api/getUser', {\n      withCredentials: true\n    }).then(response => {\n      // console.log('Informacion de usuario')\n      // console.log(response.data)\n      setUserFirstName(response.data.firstName);\n      console.log(response.data.firstName);\n      setUserRole(response.data.role);\n    }).catch(err => console.log(err));\n  }, []); //update list after delete\n\n  const filterList = deleteId => {\n    const updatedList = customers.filter(eachCust => deleteId !== eachCust._id);\n    setCustomers(updatedList);\n  };\n\n  const filterByMonth = customers => {\n    const filteredBymonth = customers.filter(item => {\n      const itemMonth = new Date(item.dos).getMonth() + 1; // month of sale of each customer (1-12)\n\n      return itemMonth == thisMonth;\n    });\n    setCustomers(filteredBymonth);\n  }; //Function para agregar comentario nuevo\n\n\n  const filterVerifList = () => {\n    axios.get(process.env.REACT_APP_API_URL + '/api/customers/all', {\n      withCredentials: true\n    }).then(response => {\n      setCustomers(response.data);\n    }).catch(err => navigate(\"/login\"));\n  }; //Calculations\n  //Calculate all de statuses  \n\n\n  let arrOfStatus = customers.map(eachRCust => eachRCust.status);\n  let sold = 0;\n  let installed = 0;\n  let contractSigned = 0;\n  let paid = 0;\n\n  for (let i = 0; i < arrOfStatus.length; i++) {\n    if (arrOfStatus[i] === 'Sold') {\n      sold++;\n    }\n\n    if (arrOfStatus[i] === 'Installed') {\n      installed++;\n    }\n\n    if (arrOfStatus[i] === 'Contract signed') {\n      contractSigned++;\n    }\n\n    if (arrOfStatus[i] === 'Paid') {\n      paid++;\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(NavBarMui, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\"Sales Dashboard Role: \", userRole]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [userRole === 'admin' && /*#__PURE__*/_jsxDEV(Statuses, {\n        sold: sold,\n        installed: installed,\n        contractSigned: contractSigned,\n        paid: paid\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 32\n      }, this), userRole === 'admin' && /*#__PURE__*/_jsxDEV(AdminTable, {\n        customers: customers,\n        thisMonth: thisMonth,\n        onDelete: filterList,\n        onFilterByMonth: filterByMonth\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 33\n      }, this), userRole === 'verif' && /*#__PURE__*/_jsxDEV(VerificationTable, {\n        customers: customers,\n        onNewComment: filterVerifList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 32\n      }, this), userRole === 'admin' && /*#__PURE__*/_jsxDEV(VerificationTable, {\n        customers: customers,\n        onNewComment: filterVerifList\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 32\n      }, this), userRole === 'sales' && /*#__PURE__*/_jsxDEV(RepView, {\n        customers: customers\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 32\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Main, \"4Vukm6vlXRc7lwd9DjNVyg5VIIE=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Main;\nexport default Main;\n\nvar _c;\n\n$RefreshReg$(_c, \"Main\");","map":{"version":3,"names":["axios","React","useState","useEffect","AdminTable","Histogram","useNavigate","NavBarMui","Statuses","VerificationTable","RepView","Main","navigate","customers","setCustomers","repsWithCustomer","setRepWithCustomer","userRole","setUserRole","thisMonth","setThisMonth","userFirstName","setUserFirstName","get","process","env","REACT_APP_API_URL","withCredentials","then","response","data","currentDate","Date","month","getMonth","toString","catch","err","console","log","firstName","role","filterList","deleteId","updatedList","filter","eachCust","_id","filterByMonth","filteredBymonth","item","itemMonth","dos","filterVerifList","arrOfStatus","map","eachRCust","status","sold","installed","contractSigned","paid","i","length"],"sources":["/Users/jorgemartinez/Documents/MERN-deployment/client/src/components/Main.jsx"],"sourcesContent":["import axios from 'axios'\nimport React, {useState, useEffect} from 'react'\nimport AdminTable from './AdminTable'\nimport Histogram from './Histogram'\nimport { useNavigate } from 'react-router-dom'\nimport NavBarMui from './NavBarMui'\nimport Statuses from './Statuses'\nimport VerificationTable from './VerificationTable'\nimport RepView from './RepView'\n\n\nconst Main = () => {\n  const navigate = useNavigate()\n  const [customers, setCustomers] = useState([])\n  const [repsWithCustomer, setRepWithCustomer] = useState([])\n  const [userRole, setUserRole] = useState('')\n  const [thisMonth, setThisMonth] = useState('')\n  const [userFirstName, setUserFirstName] = useState('')\n  \n\n  useEffect(()=>{\n    axios.get(process.env.REACT_APP_API_URL+'/api/customers/all', {withCredentials: true})\n      .then(response=>{\n        \n        setCustomers(response.data)\n\n         // Create a new Date object\n      const currentDate = new Date();\n\n      // Get the month (0-indexed, so we add 1 to get the correct month)\n      const month = currentDate.getMonth() + 1;\n\n      // Set the current month in the state\n      setThisMonth(month.toString());\n\n\n      })\n      .catch(err=>navigate(\"/login\"))\n\n\n      //retrieve customers with reps\n\n      axios.get(process.env.REACT_APP_API_URL+'/api/user/all/customers', {withCredentials: true})\n      .then(response=>{\n  \n        setRepWithCustomer(response.data)\n      })\n      .catch(err=>console.log(err))\n\n      axios.get(process.env.REACT_APP_API_URL+'/api/getUser', {withCredentials: true})\n      .then(response=>{\n        // console.log('Informacion de usuario')\n        // console.log(response.data)\n        setUserFirstName(response.data.firstName)\n        console.log(response.data.firstName)\n        setUserRole(response.data.role)\n      })\n      .catch(err=>console.log(err))\n\n  },[])\n\n\n  //update list after delete\n  const filterList = (deleteId) =>{\n    const updatedList = customers.filter((eachCust)=>deleteId!==eachCust._id)\n    setCustomers(updatedList)\n  }\n\n  const filterByMonth = (customers) => {\n    const filteredBymonth = customers.filter(item => {\n     \n      const itemMonth = new Date(item.dos).getMonth() + 1; // month of sale of each customer (1-12)\n     \n      return itemMonth == thisMonth\n    });\n    setCustomers(filteredBymonth);\n\n\n  }\n\n//Function para agregar comentario nuevo\nconst filterVerifList = () =>{\n\n  axios.get(process.env.REACT_APP_API_URL+'/api/customers/all', {withCredentials: true})\n  .then(response=>{\n    \n    setCustomers(response.data)\n\n\n  })\n  .catch(err=>navigate(\"/login\"))\n  \n}\n\n\n\n//Calculations\n\n//Calculate all de statuses  \n  let arrOfStatus = customers.map((eachRCust)=> eachRCust.status)\n  let sold = 0\n  let installed = 0\n  let contractSigned = 0\n  let paid = 0\n\n  for (let i = 0; i < arrOfStatus.length; i++){\n    if (arrOfStatus[i] === 'Sold'){\n      sold++\n    }\n    if (arrOfStatus[i] === 'Installed'){\n      installed++\n    }\n    if (arrOfStatus[i] === 'Contract signed'){\n      contractSigned++\n    }\n    if (arrOfStatus[i] === 'Paid'){\n      paid++\n    }\n  }\n\n\n  return (\n    <div>\n      <NavBarMui/>\n   \n      <h1>Sales Dashboard Role: {userRole}</h1>\n      <div>\n     \n      {userRole === 'admin' && <Statuses sold={sold} installed={installed} contractSigned={contractSigned} paid={paid}/>}\n    \n      {userRole === 'admin' &&  <AdminTable customers={customers} thisMonth={thisMonth} onDelete={filterList} onFilterByMonth={filterByMonth}/>}\n\n   \n     \n       {/* {userRole === 'admin' && <Histogram repsWithCustomer={repsWithCustomer} customers={customers}/>} */}\n      \n\n      \n      {userRole === 'verif' && <VerificationTable  customers={customers} onNewComment={filterVerifList}/>} \n      {userRole === 'admin' && <VerificationTable  customers={customers} onNewComment={filterVerifList}/>} \n\n      {userRole === 'sales' && <RepView  customers={customers} />} \n\n\n    \n      </div>\n    </div>\n  )\n}\n\nexport default Main"],"mappings":"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"},"metadata":{},"sourceType":"module"}